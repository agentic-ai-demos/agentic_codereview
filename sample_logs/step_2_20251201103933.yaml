steps:
- description: Use 'get_function_context_for_project_mcp' tool to retrieve the implementation
    details and logic of the 'infer_auto_device_map' function in the 'https://github.com/huggingface/accelerate'
    repo. This will help understand how it handles parameters like 'reserve_max_layer'
    and 'max_memory' for device mapping. The context will include function inputs,
    outputs, internal logic, and handling of different configurations.
  name: step1
  tool_results: Results from this tool will be used to verify the current behavior,
    especially how 'reserve_max_layer' influences allocation logic and whether the
    added test cases align with the function's intended design.
  tools:
  - function: get_function_context_for_project_mcp
    name: get_function_context_for_project_mcp
    parameters:
      function_name: infer_auto_device_map
      github_repo: https://github.com/huggingface/accelerate
- description: Review the newly added test cases in 'tests/test_modeling_utils.py'
    that focus on different configurations of 'reserve_max_layer' parameter, including
    cases with a single device, multiple devices, offloaded modules, tied weights,
    and various memory constraints. Assess whether these tests systematically cover
    different logical branches and scenarios of the function.
  name: step2
  tools: []
- description: Validate the correctness of the new test cases by analyzing whether
    they check for expected device maps, potential warnings, and the impact of 'reserve_max_layer'
    on allocation. Confirm that the test expectations are consistent with the understood
    implementation logic from the function context.
  name: step3
  tools: []
- description: Identify any potential edge cases or scenarios that might not be covered
    by existing tests, such as extremely limited memory, conflicting resource availability,
    or unusual module configurations. Add notes or suggestions for additional tests
    if necessary.
  name: step4
  tools: []
- description: 'Summarize the review findings: confirm that the new tests appropriately
    verify different ''reserve_max_layer'' behaviors, ensure the implementation aligns
    with the expectations, and determine if any code changes are recommended. Provide
    insights on possible improvements or clarifications needed in the implementation
    or tests.'
  name: step5
  tools: []
summary: The review plan involves systematically understanding the test function modifications,
  especially the parameter changes of 'infer_auto_device_map', the logic behind device
  mapping, and how the 'reserve_max_layer' parameter influences allocation. Additional
  context from the function's implementation will be gathered using the 'get_function_context_for_project_mcp'
  tool. This ensures that the code changes are correct, consistent, and improve or
  maintain the intended functionality.
version: 1
